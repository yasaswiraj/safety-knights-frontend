<h2 class="dialog-title">Update Status</h2>
<div class="dialog-content">
  <h2>Job {{ data.job_id }}</h2>
      <!-- Close Icon Button -->
      <button mat-icon-button class="absolute top-2 right-2" (click)="closeDialog()">
        <mat-icon>close</mat-icon>
      </button>
        
      <div class="details-wrapper">
        <!-- Job Description Section -->
         <!-- Job Description Section -->
    <div class="description">
      <p><strong> Job description</strong> {{ data.work_in_detail }}</p> 
      <p><strong>Scope of Service:</strong> {{ data.scope_of_service }}</p>
      <p><strong> Expected Start Date:</strong> {{ jobDetails.expected_start_date }}</p>
      <p><strong>Deadline:</strong> {{ data.deadline }}</p>  
      <p><strong>Location:</strong> {{ data.location }}</p>
      <p><strong>Budget:</strong>{{ data.budget }} </p>
      <!-- <p><strong>Access type  :</strong> {{ jobDetails.access_type }}</p> -->
      
      <div *ngIf="jobDetails.form_responses && (objectKeys(jobDetails.form_responses).length > 0); else noForms">
        <ul>
          <li *ngFor="let key of objectKeys(jobDetails.form_responses)">
            <strong>{{ key }}:</strong> {{ jobDetails.form_responses[key] }}
          </li>
        </ul>
      </div>
      <ng-template #noForms>No form responses provided.</ng-template>
        
    

    <p><strong>Insurance Values</strong></p>
    <div *ngIf="jobDetails.insurance_values.length > 0; else noInsurance">
      <ul>
        <li *ngFor="let insurance of jobDetails.insurance_values">
          {{ insurance }}
        </li>
      </ul>
    </div>
    <ng-template #noInsurance>No insurance values provided.</ng-template>

    <p><strong>File Attachments</strong></p>

    <li *ngFor="let file of jobDetails.file_attachments">
      <a [href]="file.file_location" target="_blank" rel="noopener noreferrer">
        {{ file.file_location.split('/').pop() }}
      </a>
    </li>
    

<ng-template #noFiles>
  <p>No file attachments available.</p>
</ng-template></div>
  
        <!-- Client Contact Information Section -->
        <div class="client-info">
          <h1><strong>Client Information:</strong></h1>
          <p><strong>Phone:</strong> {{ data.phone }}</p>
          <p><strong>Email:</strong> {{ data.email }}</p>
          <p><strong>Client Name:</strong> {{ data.name }}</p>
          <p><strong>Client Rating:</strong> {{ data.rating }}</p>
          <button
            type="button"
            class="mt-3 bg-gradient-to-r from-[#b68d5f] to-[#a4784c] text-white font-semibold text-sm py-2 px-6 rounded-full shadow-md hover:from-[#a4784c] hover:to-[#8d6640] transition"
            (click)="getUserDetailsByJobId(data.job_id)">
            Message Client
          </button>
        </div>


      </div>
      
      
    
      <div>
        <!-- <br>
        <textarea placeholder="Add Comments" [(ngModel)]="comment"  class="w-full h-32 p-2 border border-black rounded-md resize-none"></textarea> -->

        <div *ngIf="regularComments?.length && regularComments.length > 0">
          <h4 class="mb-2 font-semibold">Previous Comments:</h4>
          <ul class="mb-4 list-disc list-inside text-sm text-gray-700">
            <li *ngFor="let comment of regularComments">
              <strong>{{ comment.user_name }}:</strong> {{ comment.comment }} 
              <small class="text-gray-500">({{ comment.created_at | date:'short' }})</small>
            </li>
          </ul>
        </div>
        
        <textarea 
          placeholder="Add Comments" 
          [(ngModel)]="comment"  
          class="w-full h-32 p-2 border border-black rounded-md resize-none"
        ></textarea>
        


        <h4>Update Job Status:</h4>
        <label>
          <input type="radio" name="status" value="in_progress" [(ngModel)]="selectedStatus"> In Progress
        </label><br>
        <label>
          <input type="radio" name="status" value="active" [(ngModel)]="selectedStatus"> Active
        </label><br>
        <label>
          <input type="radio" name="status" value="closed" [(ngModel)]="selectedStatus"> Closed
        </label><br>

      </div>
 

  <div class="dialog-actions">
    <button class="mt-5 bg-gradient-to-r from-[#b68d5f] to-[#a4784c] text-white font-semibold text-sm py-2 px-6 rounded-full shadow-md hover:from-[#a4784c] hover:to-[#8d6640] transition" (click)="updateJobStatus()">Update</button>
   
  </div>
</div>
